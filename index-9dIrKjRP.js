function t(){bt=ut.xr.t();const t={x:-1*vt.x,y:-1*vt.y,z:-1*vt.z,w:1},e=new c.o,n=new XRRigidTransform(t,e),s=bt.getOffsetReferenceSpace(n);ut.xr.i(s)}function e(t){const e=t.target,n="left"===t.data.handedness?-1:1;if(!e.l("target")){const t=new c.h;t.name="target",t.rotation.set(0,0,0),t.position.set(-1*n*.035,.05,-.12),e.add(t)}let s=e.l("paw");s||(s=((t={})=>{const e=new c.h;e.name="paw";const n=et(["cy,cylinder,4,6,2,,-1,,,,,,-1,,4","s,sphere,4,4,2,,2,,,,,,2,,4","c,cube,0.3,1,0.3,-1.15,3.5,-0.55,-77,,,-1.15,3.5,-0.55,9","c,cube,0.3,1,0.3,-0.45,3.9,-0.55,-77,,,-0.45,3.9,-0.55,9","c,cube,0.3,1,0.3,0.45,3.9,-0.55,-77,,,0.45,3.9,-0.55,9","c,cube,0.3,1,0.3,1.05,3.6,-0.55,-77,,,1.05,3.6,-0.55,9","c,cube,2,0.7,0.4,,1.85,-0.9,,,,,1.5,-0.1,3","c,cube,0.8,0.5,1.1,,2.45,-0.55,,,,,2.2,-0.1,3","c,cube,0.3,0.6,0.6,-1.15,2.7,-0.8,,,,-1.15,2.7,-0.1,3","c,cube,0.3,0.6,0.6,-0.45,3.1,-0.8,,,,-0.45,3.1,-0.1,3","c,cube,0.3,0.6,0.6,0.45,3.1,-0.8,,,,0.45,3.1,-0.1,3","c,cube,0.3,0.6,0.6,1.05,2.7,-0.8,,,,1.05,2.7,-0.1,3"],{...rt,...t});return n.scale.set(.03125,.03125,.03125),n.rotation.set(3*Math.PI/2,0,0),e.u(n),e})(),s.position.set(0,0,.15),e.add(s));let r=e.l("line");if(!r){const t=(new c.v).p([new c.m(0,0,0),new c.m(0,0,-1)]);r=new c.M(t),r.R.color.set(16711680),r.name="line",r.scale.z=5,e.add(r)}}function n(t){wt=t.target;const e=r(wt);if(e.length>0){let t=!1;e.forEach(({object:e})=>{if(t)return;let n=e;for(;n;){if(n.S){n.S(wt),t=!0,wt.l("line").visible=!1;break}n=n.parent}})}wt.k.targetRayMode=t.data.targetRayMode}function s(t){wt=t.target;const e=wt.k.selected;e?.A&&e.A(wt),wt.l("line").visible=!0}function r(t){return t.B(),ht.P(t),ht.O(lt.children,!0)}function o(t){if("screen"===t.k.targetRayMode)return;if(void 0!==t.k.selected)return;const e=t.l("line"),n=r(t);if(e&&(e.scale.z=5),n.length>0){let t=!1;n.forEach(({object:n,C:s})=>{if(t)return;let r=n;for(;r;){if(r.k.T){const n=r.l("highlight");n&&(n.visible=!0),e&&(e.scale.z=s),gt.push(r),t=!0;break}r=r.parent}})}}function i(){const t=ct.I();pt+=t,.5>pt||(a.Instance.emit("beat"),pt-=.5),q.Instance.update(),a.Instance.emit("tick",t),(()=>{for(;gt.length;){const t=gt.pop().l("highlight");t&&(t.visible=!1)}})(),o(ft),o(dt),ut.L(lt,at)}import*as c from"https://js13kgames.com/2025/webxr/three.module.js";class a{static D;N;constructor(){this.N={}}static get Instance(){return a.D||(a.D=new a),a.D}on(t,e){this.N[t]=this.N[t]||[],this.N[t].push(e)}off(t,e){this.N[t]=(this.N[t]||[]).filter(t=>t!==e)}emit(t,...e){(this.N[t]||[]).forEach(t=>t(...e))}V(){Object.keys(this.N).forEach(t=>{delete this.N[t]})}$(){return this.N}}const l="#e81416",h="#ffa500",u="#faeb36",w="#79c314",f="#487de7",d="#70369d",p="#ffffff",g="#000000",b="#abb7d0",v="#ff3b94",m="#f6ff00",y="#8ea5ff",M="#333333",R={color:l,artist:w,title:f},S=[l,h,u,w,f,d],k=["Shiny Toy Guns","B.B. King","Jack White","Black Sabbath","Faith Hill","Cliff Sheen"],A=["OFFSIDE","SHOWCASE","LOADOUT","BACKHAND","BOOKMARKS","MANPOWER"],x={color:S,artist:k,title:A},B={color:0,artist:24,title:34},P=[[0,1,2,3,4,5],[0,2,4,1,5,3],[0,3,5,1,4,2]],O=["color","artist","title"];class C{queue;selected;G;W;constructor(){this.queue=[],this.selected={},this.G=[],this.reset(),this.W.F="color"}_(t){if(this.queue[0]===t)return;const{color:e,artist:n,title:s}=this.G[t],r=S.indexOf(e),o=k.indexOf(n),i=A.indexOf(s);r===this.W.color.q+1?(this.W.color.Y++,this.W.color.Y===S.length&&(this.W.color.j=!0),this.W.color.q=r):(this.W.color.q=-1,this.W.color.Y=0),o===(this.W.artist.q+1)%k.length?(this.W.artist.Y++,this.W.artist.Y===k.length&&(this.W.artist.j=!0)):this.W.artist.Y=1,this.W.artist.q=o,i===(this.W.title.q+1)%A.length?(this.W.title.Y++,this.W.title.Y===A.length&&(this.W.title.j=!0)):this.W.title.Y=1,this.W.title.q=i;const c=Math.max(this.W.color.Y,this.W.artist.Y,this.W.title.Y);6>this.W.U&&this.W.U>c&&a.Instance.emit("comboBroken"),this.W.U=c,this.W.F=this.W.color.Y===this.W.U?"color":this.W.artist.Y===this.W.U?"artist":"title",this.queue.unshift(t),this.W.X=this.H(),a.Instance.emit("progress",this.W)}K(t){return this.G[this.queue[t]]}J(t){if(t)return this.W[t].j}H(){let t="";const{q:e,Y:n}=this.W[this.W.F],s=x[this.W.F];for(let r=0;n>r;r++){let n=e-r;0>n&&(n+=s.length),t=`${s[n]}â†’${t}`}return t}reset(){this.queue=[],this.selected={};const[t,e,n]=P;this.W={color:{q:-1,Y:0,j:!1},artist:{q:-2,Y:0,j:!1},title:{q:-2,Y:0,j:!1},F:"color",U:0},this.G=S.map((t,e)=>({index:e,color:t,artist:"",title:""})),t.forEach((t,e)=>{this.G[t].color=S[e]}),e.forEach((t,e)=>{this.G[t].artist=k[e]}),n.forEach((t,e)=>{this.G[t].title=A[e]}),a.Instance.emit("progress",this.W)}}class T{static Z(t,e={}){function n(){s.style.display="block",s.setAttribute("data-disabled","true"),s.onmouseenter=null,s.onmouseleave=null,s.onclick=null}const s=document.createElement("button");if("xr"in navigator)return s.id="VRButton",s.style.display="none",navigator.xr.isSessionSupported("immersive-vr").then(r=>{r?(()=>{async function n(e){e.addEventListener("end",r),await t.xr.tt(e),s.textContent="EXIT VR",o=e}function r(){o.removeEventListener("end",r),s.textContent="ENTER VR",o=null}let o=null;s.style.display="block",s.removeAttribute("data-disabled"),s.textContent="ENTER VR";const i={...e,et:["local-floor","bounded-floor","layers",...e.et||[]]};s.onclick=()=>{null===o?navigator.xr.requestSession("immersive-vr",i).then(n):(o.end(),void 0!==navigator.xr.offerSession&&navigator.xr.offerSession("immersive-vr",i).then(n).catch(()=>{}))},void 0!==navigator.xr.offerSession&&navigator.xr.offerSession("immersive-vr",i).then(n).catch(()=>{})})():(n(),s.textContent="VR NOT SUPPORTED"),r&&T.nt&&s.click()}).catch(()=>{n(),s.textContent="VR NOT ALLOWED"}),s;{const t=document.createElement("a");return!1===window.isSecureContext?(t.href=document.location.href.replace(/^http:/,"https:"),t.innerHTML="WEBXR NEEDS HTTPS"):(t.href="https://immersiveweb.dev/",t.innerHTML="WEBXR NOT AVAILABLE"),t.className="webxr-message",t}}static st(){if("undefined"!=typeof navigator&&"xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",()=>{T.nt=!0})}}}T.nt=!1,T.st();const E=.0254,I=(t=1024,e=1024)=>{const n=document.createElement("canvas");n.width=t,n.height=e;const s=n.getContext("2d");return[n,s]},L=(t,e,n)=>{const s=new c.m(1,0,0),r=new c.rt(0,t,-Math.PI/2+e);return s.it(r).normalize().ot(n)},D=t=>parseFloat(""+(t||0)),z=t=>t[Math.floor(Math.random()*t.length)],N={},V=new c.ct,$=(t,e)=>{const n=1==e?.lt,s=`color-${t}-${n}`;if(N[s])return N[s];const r=new(n?c.ht:c.ut)({color:t,wt:c.ft});return N[s]=r,r},G=(t,e)=>{const{color:n,textAlign:s,ratio:r,fontSize:o}=e;V.set(n);const i="string"==typeof n?n:"#"+V.dt(),a=`text-${i}-${t.join("")}`;if(N[a])return N[a];const l=1024,h=r?l/r:l,[u,w]=I(l,h);w.textAlign=s||"center";let f=16;"center"===w.textAlign&&(f=512),t.forEach((t,e)=>{const n=void 0!==o?o:64;w.strokeStyle=g,w.font=n+"px monospace",w.textBaseline="top",w.lineWidth=8,w.strokeText(t,f,16+n*e),w.fillStyle=i,w.fillText(t,f,16+n*e)});const d=new c.gt(u),p=new c.ht({map:d,bt:!0});return N[a]=p,p},W=t=>t*t,F=t=>.5>t?4*t*t*t:1-Math.pow(-2*t+2,3)/2,_=t=>.5*Math.cos(2*t*Math.PI+Math.PI)+.5;class q{static D;vt;yt;Mt;constructor(){this.vt=[],this.yt=null,this.Mt=new c.Rt}static get Instance(){return q.D||(q.D=new q),q.D}St(t){this.yt||(this.yt=t,this.Mt.start())}update(){const t=1e3*this.Mt.kt();this.vt=this.vt.filter(e=>{const{At:n,start:s,end:r,xt:o,loop:i}=e,a=e.endTime-e.startTime,l=c.Pt.Bt((t-e.startTime)/a,0,1);if(r.position&&n.position.Ot(s.position,r.position,o(l)),r.rotation){const t=s.rotation,e=r.rotation,i=new c.rt;i.order=t.order||c.rt.Ct,i.x=t.x+(e.x-t.x)*o(l),i.y=t.y+(e.y-t.y)*o(l),i.z=t.z+(e.z-t.z)*o(l),n.rotation.Tt(i)}return r.Et&&n.scale.Ot(s.Et,r.Et,o(l)),e.endTime>t||(i?(e.startTime=t,e.endTime=t+a,r.position&&n.position.Tt(s.position),r.rotation&&n.rotation.Tt(s.rotation),r.Et&&n.scale.Tt(s.Et),!0):(e.resolve&&(e.resolve(),e.resolve=void 0,e.reject=void 0),!1))})}It(t){const{At:e,end:n}=t,s=t.duration||1e3,r=t.delay||0,o=t.Lt||W,i=1e3*this.Mt.kt();let c,a;const l=new Promise((t,e)=>{c=t,a=e});return this.vt.push({At:e,start:{position:e.position.clone(),rotation:e.rotation.clone(),Et:e.scale.clone()},end:n,xt:o,startTime:i+r,endTime:i+r+s,loop:t.loop||!1,resolve:c,reject:a}),l}Dt(t,e=!1){const n=this.vt.filter(e=>e.At===t);n.length&&(n.forEach(n=>{const{end:s}=n;e&&(s.position&&t.position.Tt(s.position),s.rotation&&t.rotation.Tt(s.rotation),s.Et&&t.scale.Tt(s.Et)),n.reject&&(n.reject(),n.resolve=void 0,n.reject=void 0)}),this.vt=this.vt.filter(e=>e.At!==t))}}class Y{constructor(){this.zt=[this.Nt.bind(this),this.Vt.bind(this),this.$t.bind(this),this.Gt.bind(this)],this.Wt=null,this.Ft=0,this._t=0,this.qt=0,this.Yt=null}Nt(t){return Math.sin(6.283184*t)}$t(t){return t%1*2-1}Vt(t){return.5>t%1?1:-1}Gt(t){var e=t%1*4;return 2>e?e-1:3-e}jt(t){return.003959503758*2**((t-128)/12)}Ut(t,e,n){var s,r,o,i,c,a,l=this.zt[t.Xt[0]],h=t.Xt[1],u=t.Xt[3]/32,w=this.zt[t.Xt[4]],f=t.Xt[5],d=t.Xt[8]/32,p=t.Xt[9],g=t.Xt[10]*t.Xt[10]*4,b=t.Xt[11]*t.Xt[11]*4,v=t.Xt[12]*t.Xt[12]*4,m=1/v,y=-t.Xt[13]/16,M=t.Xt[14],R=n*2**(2-t.Xt[15]),S=new Int32Array(g+b+v),k=0,A=0;for(s=0,r=0;g+b+v>s;s++,r++)0>r||(r-=R,c=this.jt(e+(15&(M=M>>8|(255&M)<<4))+t.Xt[2]-128),a=this.jt(e+(15&M)+t.Xt[6]-128)*(1+8e-4*t.Xt[7])),o=1,g>s?o=s/g:g+b>s||(o=(1-(o=(s-g-b)*m))*3**(y*o)),i=l(k+=c*o**u)*h,i+=w(A+=a*o**d)*f,p&&(i+=(2*Math.random()-1)*p),S[s]=80*i*o|0;return S}async init(t){return new Promise(e=>{this.Wt=t,this.Ft=t.Ht,this._t=0,this.qt=t.Kt*t.Jt*(this.Ft+1)*2,this.Yt=new Int32Array(this.qt),e()})}Qt(t){return new Promise(e=>{var n,s,r,o,i,c,a,l,h,u,w,f,d,p,g=new Int32Array(this.qt),b=this.Wt.Zt[t],v=this.Wt.Kt,m=this.Wt.Jt,y=0,M=0,R=!1,S=[];for(r=0;this.Ft>=r;++r)for(a=b.te[r],o=0;m>o;++o){var k=a?b.c[a-1].f[o]:0;k&&(b.Xt[k-1]=b.c[a-1].f[o+m]||0,17>k&&(S=[]));var A=this.zt[b.Xt[16]],x=b.Xt[17]/512,B=2**(b.Xt[18]-9)/v,P=b.Xt[19],O=b.Xt[20],C=135.82764118168*b.Xt[21]/44100,T=1-b.Xt[22]/255,E=1e-5*b.Xt[23],I=b.Xt[24]/32,L=b.Xt[25]/512,D=6.283184*2**(b.Xt[26]-9)/v,z=b.Xt[27]/255,N=b.Xt[28]*v&-2;for(w=(r*m+o)*v,i=0;4>i;++i)if(c=a?b.c[a-1].n[o+i*m]:0){S[c]||(S[c]=this.Ut(b,c,v));var V=S[c];for(s=0,n=2*w;V.length>s;s++,n+=2)g[n]+=V[s]}for(s=0;v>s;s++)(u=g[l=2*(w+s)])||R?(f=C,P&&(f*=A(B*l)*x+.5),M+=(f=1.5*Math.sin(f))*(d=T*(u-M)-(y+=f*M)),u=3==O?M:1==O?d:y,E&&(u=1>(u*=E)?u>-1?this.Nt(.25*u):-1:1,u/=E),R=(u*=I)*u>1e-5,p=u*(1-(h=Math.sin(D*l)*L+.5)),u*=h):p=0,N>l||(p+=g[l-N+1]*z,u+=g[l-N]*z),g[l]=0|p,g[l+1]=0|u,this.Yt[l]+=0|p,this.Yt[l+1]+=0|u}e()})}async ee(){this.Yt.fill(0),this._t=0;const t=[];for(let e=0;this.Wt.ne>e;e++)t.push(this.Qt(e));return await Promise.all(t),this._t=this.Wt.ne,1}se(t){for(var e=t.createBuffer(2,this.qt/2,44100),n=0;2>n;n++)for(var s=e.getChannelData(n),r=n;this.qt>r;r+=2)s[r>>1]=this.Yt[r]/65536;return e}re(t,e=0,n=null){(null===n||n>this.qt/2)&&(n=this.qt/2),0>e&&(e=0),n>e||(e=n-1);const s=n-e;for(var r=t.createBuffer(2,s,44100),o=0;2>o;o++)for(var i=r.getChannelData(o),c=0;s>c;c++)i[c]=this.Yt[2*(e+c)+o]/65536;return r}oe(){var t=44+2*this.qt-8,e=t-36,n=new Uint8Array(44+2*this.qt);n.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var s=0,r=44;this.qt>s;++s){var o=this.Yt[s];n[r++]=255&(o=-32767>o?-32767:o>32767?32767:o),n[r++]=o>>8&255}return n}ie(t=0,e=null){(null===e||e>this.qt/2)&&(e=this.qt/2),0>t&&(t=0),e>t||(t=e-1);const n=e-t;var s=44+2*n-8,r=s-36,o=new Uint8Array(44+2*n);o.set([82,73,70,70,255&s,s>>8&255,s>>16&255,s>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&r,r>>8&255,r>>16&255,r>>24&255]);for(var i=0,c=44;n>i;++i){var a=this.Yt[2*(t+i)];o[c++]=255&(a=-32767>a?-32767:a>32767?32767:a),o[c++]=a>>8&255}return o}getData(t,e){for(var n=2*Math.floor(44100*t),s=Array(e),r=0;2*e>r;r+=1){var o=n+r;s[r]=t>0&&this.Yt.length>o?this.Yt[o]/32768:0}return s}}const j=44100,U=new(window.AudioContext||window.webkitAudioContext),X=(...t)=>((...t)=>{let e=U.createBufferSource(),n=U.createBuffer(t.length,t[0].length,j);return t.map((t,e)=>n.getChannelData(e).set(t)),e.buffer=n,e.connect(U.destination),e.start(),e})(((t=1,e=.05,n=220,s=0,r=0,o=.1,i=0,c=1,a=0,l=0,h=0,u=0,w=0,f=0,d=0,p=0,g=0,b=1,v=0,m=0)=>{let y,M,R=2*Math.PI,S=a*=500*R/j**2,k=(d>0?1:-1)*R/4,A=n*=(1+2*e*Math.random()-e)*R/j,x=[],B=0,P=0,O=0,C=1,T=0,E=0,I=0;for(l*=500*R/j**3,d*=R/j,h*=R/j,u*=j,w=j*w|0,M=(s=99+j*s)+(v*=j)+(r*=j)+(o*=j)+(g*=j)|0;M>O;x[O++]=I)++E%(100*p|0)||(I=i?i>1?i>2?i>3?Math.sin((B%R)**3):Math.max(Math.min(Math.tan(B),1),-1):1-(2*B/R%2+2)%2:1-4*Math.abs(Math.round(B/R)-B/R):Math.sin(B),I=(w?1-m+m*Math.sin(2*Math.PI*O/w):1)*(I>0?1:-1)*Math.abs(I)**c*t*.3*(s>O?O/s:s+v>O?1-(O-s)/v*(1-b):s+v+r>O?b:M-g>O?(M-O-g)/o*b:0),I=g?I/2+(g>O?0:(M-g>O?1:(M-O)/g)*x[O-g|0]/2):I),y=(n+=a+=l)*Math.sin(P*d-k),B+=y-y*f*(1-1e9*(Math.sin(O)+1)%2),P+=y-y*f*(1-1e9*(Math.sin(O)**2+1)%2),C&&++C>u&&(n+=h,A+=h,C=0),!w||++T%w||(n=A,a=S,C=C||1);return x})(...t));var H={Zt:[{Xt:[0,255,116,85,0,255,116,0,37,14,4,6,73,99,0,0,0,0,0,0,2,136,15,0,32,0,0,0,6],te:[1,1,1,2,,,1,1,2,2],c:[{n:[139,,,,139,,,,139,,,,139,,,,139,,,,139,,,,139,,139,,139,,139],f:[]},{n:[140,,140,,,,140,,,,140,,140,,140,,,,140,,140,,,,140,,140,,,,140],f:[]}]},{Xt:[0,160,128,64,0,160,128,0,64,210,4,7,52,85,0,0,0,60,4,1,2,255,0,0,32,61,5,0,6],te:[,1,2,1,2,1,2,1,1,1],c:[{n:[,,,,139,,,,,,,,139,,,,,,,,139,,,,,,,,139,,139],f:[]},{n:[,,,,,,,,,,,,139,,139,,,,,,,,,,,,,,139,,139],f:[]}]},{Xt:[0,255,106,64,0,255,106,0,64,0,5,7,164,0,0,0,0,0,0,0,2,255,0,2,32,83,5,25,1],te:[,,,,1,,2,1,1,2],c:[{n:[144,,,,,,,,,,,,,,,,144],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,156,,,,,,,,,,,,,,,,156],f:[]}]},{Xt:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],te:[,,,,1,1,1,1,2,2],c:[{n:[132,,,,,,,,132,,,,,,,,144,,,,,,,,144],f:[]},{n:[],f:[]}]},{Xt:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],te:[,,2,1,,2,1,2,2,1],c:[{n:[144,,,,144,,,,144,,,,142,,142,,144,,144,,144,,,,144,,,,144,,,,147,,,,151,,,,147,,,,149,,149,,147,,147,,151,,,,147,,,,147,,,,151,,,,154,,,,151,,,,151,,151,,151,,151,,154,,,,151,,,,151],f:[]},{n:[144,144,144,,144,,,,,,,,,,,,,,,,,,,,,,,,,,,,147,147,147,,147,,,,,,,,,,,,,,,,,,,,,,,,,,,,151,151,151,,151],f:[]}]}],Kt:5513,Jt:32,Ht:9,ne:5};const K=new AudioContext;let J=0;a.Instance.on("progress",t=>{J=Math.min(t.U||0,6)});const Q=()=>X(...[,,143,.03,.17,.09,2,1.5,10,-17,,,,,4,,,.73,.09]),Z=["Light Blue","Yellow","Orange","Red","Purple","Blue","Green","Lime","Pink","Silver"],tt={"Light Blue":"#9999ff",ce:"#fffb00",ae:"#ff7300",le:"#ff0000",he:"#c300ff",ue:"#0000ff",we:"#00ff00",fe:"#b0ffb0",de:"#ff00ff",pe:"#d3d3d3"},et=(t,e)=>{const n=new c.h;n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1);const s={...tt,...e};return t.forEach(t=>{if(null!==t)if(Array.isArray(t))n.add(et(t,s));else{const[e,r,o,i,a,l,h,u,w,f,d,p,g,b,v]=t.split(","),m=(t=>{const[e]=t.split(",");switch(e){case"c":return(t=>{const[e,n,s,r,o,i,a,l,h,u,w,f,d,p,g]=t.split(","),b=D(s),v=D(r),m=D(o),y=D(i),M=D(a),R=D(l),S=D(f),k=D(d),A=D(p),x=D(h),B=D(u),P=D(w),O=new c.ge(b,v,m);return O.translate(y-S,M-k,R-A),O.be(c.Pt.ve(x)),O.me(c.Pt.ve(B)),O.ye(c.Pt.ve(P)),O.Me(),O})(t);case"s":return(t=>{const[e,n,s,r,o,i,a,l,h,u,w,f,d,p,g]=t.split(","),b=D(s),v=D(r),m=D(o),y=D(i),M=D(a),R=D(l),S=D(f),k=D(d),A=D(p),x=D(h),B=D(u),P=D(w),O=new c.Re(b/2,32,16);return O.scale(b/b,v/b,m/b),O.translate(y-S,M-k,R-A),O.be(c.Pt.ve(x)),O.me(c.Pt.ve(B)),O.ye(c.Pt.ve(P)),O})(t);case"p":return(t=>{const[e,n,s,r,o,i,a,l,h,u,w,f,d,p,g]=t.split(","),b=D(s),v=D(r),m=D(i),y=D(a),M=D(l),R=D(f),S=D(d),k=D(p),A=D(h),x=D(u),B=D(w),P=new c.Se(b,v);return P.be(c.Pt.ve(-90)),P.translate(m-R,y-S,M-k),P.be(c.Pt.ve(A)),P.me(c.Pt.ve(x)),P.ye(c.Pt.ve(B)),P.Me(),P})(t);case"cy":return(t=>{const[e,n,s,r,o,i,a,l,h,u,w,f,d,p,g]=t.split(","),b=D(s),v=D(r),m=D(o),y=D(i),M=D(a),R=D(l),S=D(f),k=D(d),A=D(p),x=D(h),B=D(u),P=D(w),O=b/2,C=new c.ke(O,O,v,32);C.translate(y-S,M-k,R-A),C.scale(1,1,m/b);const T=c.Pt.ve(x),E=c.Pt.ve(B),I=c.Pt.ve(P),L=new c.rt(T,E,I);return C.Ae((new c.o).xe(L)),C.Me(),C})(t);case"py":return(t=>{const[e,n,s,r,o,i,a,l,h,u,w,f,d,p,g]=t.split(","),b=D(s),v=D(r),m=D(o),y=D(i),M=D(a),R=D(l),S=D(f),k=D(d),A=D(p),x=D(h),B=D(u),P=D(w),O=new c.ke(0,Math.sqrt(b*b+b*b)/2,v,4,1,!1,Math.PI/4);return O.scale(1,1,m/b),O.translate(y-S,M-k+.3*v,R-A),O.be(c.Pt.ve(x)),O.me(c.Pt.ve(B)),O.ye(c.Pt.ve(P)),O})(t);default:throw Error("Unknown shape: "+e)}})(t);let y=new c.ut({color:s[Z[v]],wt:c.Be});const M=new c.Pe(m,y);M.name=r,M.position.set(p,g,b),n.add(M)}}),n},nt=[{he:M,pe:"#888888",ce:b,le:v},{he:h,pe:u,ce:"#1aff1a",le:v},{he:"#666666",pe:b,ce:m,le:v}];class st{Mt;parent;Oe;Ce;constructor(){this.Mt=new c.Rt,this.parent=new c.h,this.parent.name="Grid",this.Ce=new c.Se(20,26,20,26),this.Ce.be(Math.PI/2),this.Oe=new c.Pe(this.Ce,new c.ht({color:"#ff00ff",Te:!0})),this.parent.add(this.Oe),a.Instance.on("tick",()=>{const t=this.Ce.getAttribute("position");for(let e=0;t.Ee.length>e;e+=3){const n=t.Ee[e],s=t.Ee[e+2];t.Ee[e+1]=.5*Math.sin(Math.sqrt(n*n+s*s)-2*this.Mt.kt())}t.Ie=!0}),a.Instance.on("progress",t=>{!this.Oe.R.visible&&t.U>5&&(this.Oe.position.set(0,-5,0),q.Instance.It({At:this.Oe,end:{position:new c.m(0,0,0)},Lt:F,duration:2e3})),this.Oe.R.visible=t.U>5})}get At(){return this.parent}}const rt={he:M,le:v,pe:p},ot=[{},{ae:"#af3dff",he:g,pe:y}],it=new c.m(.05,.05,.05),ct=new c.Rt;let at,lt,ht,ut,wt,ft,dt,pt=0;const gt=[];let bt;const vt=new c.m(0,0,.3),mt=async()=>{document.getElementById("p").setAttribute("disabled","true"),document.getElementById("p").innerHTML="LOADING...",ut=new c.Le({antialias:!0}),ut.De(window.devicePixelRatio),ut.ze(window.innerWidth,window.innerHeight),ut.Ne("#000000"),ut.xr.addEventListener("sessionstart",t),ut.xr.enabled=!0,ut.Ve(i),document.body.appendChild(T.Z(ut)),document.body.appendChild(ut.$e);const r=new C;lt=new c.Ge,at=new c.We(75,window.innerWidth/window.innerHeight,.1,1e3),at.position.set(0,2,1),at.rotation.set(-1*Math.PI/12,0,0),at.name="camera",lt.add(at),q.Instance.St(lt);const o=new c.Fe(16777215,.8);lt.add(o);const k=new c._e(16777215,.8);k.position.set(6,10,8),k.qe=!0,k.target.position.set(0,0,0),lt.add(k),lt.add(k.target);const A=(()=>{const t=new c.h;t.name="Sky";const e=new c.Ye,n=30,s=new c.ge,r=new c.ut,o=[];let i=0,l=0;const h=new c.je(s,r,900);h.Xe.Ue(c.He);const u=new c.ct,w=[new c.ct(65535),new c.ct(16776960),new c.ct(16711935)];let f=0;for(let t=0;n>t;t++)for(let s=0;n>s;s++){const r=L(0,2*s*Math.PI/n,15);r.z=4*-t,e.position.Tt(r),e.scale.set(1,1,2),e.Ke(),u.Je(1,.5+.5*Math.random(),.5+.5*Math.random()),o.push(u.Qe()),h.Ze(f,e.matrix),h.tn(f,u.multiply(w[0])),f++}return t.add(h),a.Instance.on("tick",t=>{i+=t;for(let t=0;h.count>t;t++){h.en(t,e.matrix),e.matrix.nn(e.position,e.quaternion,e.scale);const s=Math.floor(t/n),r=s%2?1:-1,o=4*-s;e.position.Tt(L(0,t%n*2*Math.PI/n+.05*r*i,15)),e.position.z=o+l*r*Math.sin(i),e.Ke(),h.Ze(t,e.matrix)}h.Xe.Ie=!0}),a.Instance.on("progress",t=>{l=2>t.U?0:1}),t})();A.position.set(0,0,5),lt.add(A);const x=(t=>{const e=et([["c,desk,2,0.1,1,,0.85,-0.5,,,,,-0.1,,6","c,leg,0.1,0.8,0.1,-0.85,0.4,-0.85,,,,0.1,,-0.9,6","c,leg,0.1,0.8,0.1,-0.85,0.4,-0.15,,,,0.1,,-0.2,6","c,leg,0.1,0.8,0.1,0.85,0.4,-0.15,,,,1.8,,-0.2,6","c,leg,0.1,0.8,0.1,0.85,0.4,-0.85,,,,1.8,,-0.9,6","c,record-rack,0.4,0.1,0.8,0.7,0.95,-0.5,,,,0.7,0.95,-0.5,0","c,cube,0.3,0.1,0.4,-0.75,0.95,-0.3,,,,-0.75,0.95,-0.3,9","c,cube,0.4,0.1,0.4,-0.3,0.95,-0.3,,,,-0.3,0.95,-0.3,9","c,tableA,0.4,0.1,0.4,0.2,0.95,-0.3,,,,0.2,1.01,-0.3,0","cy,pad,0.4,0.02,0.4,0.2,1,-0.3,,,,0.2,1,-0.3,3"],"c,cube,22,1,4,,-1.5,-23,,,,,-2,-15,2","c,floor,20,1,20,,-2.5,-11,,,,,-3,-4,3","c,cube,20,1,6,,-2.5,2,,,,,-3,5,3","c,cube,8,2,3,,-1,0.5,,,,,-1,-4,2","c,pillar,1,4,1,6.5,,-6.5,,,,7,,-7,6","c,pillar,1,4,1,6.5,,-10.5,,,,7,,-11,6","c,pillar,1,3,1,6.5,0.5,-14.5,,,,7,,-15,6","c,pillar,1,4,1,6.5,,-18.5,,,,7,,-19,6","c,pillar,1,4,1,6.5,,-14.5,,,,7,,-15,6","c,pillar,1,4,1,-6.5,,-6.5,,,,-6,,-7,6","c,pillar,1,4,1,-6.5,,-2.5,,,,-6,,-3,6","c,pillar,1,4,1,6.5,,-2.5,,,,7,,-3,6","c,pillar,1,4,1,-6.5,,-10.5,,,,-6,,-11,6","c,pillar,1,4,1,-6.5,,-14.5,,,,-6,,-15,6","c,pillar,1,4,1,-6.5,,-18.5,,,,-6,,-19,6","c,cube,4,1,20,8,2.5,-11,,,,7,2,-3,1","c,cube,4,1,20,-8,2.5,-11,,,,-9,2,-3,1"],{we:"#93e0a8",ce:b,ae:"#687793",le:"#42485d","Light Blue":f}),n=(()=>{const t=et(["c,base,13,1,3,-1.5,0.5,-0.5,,,,,,,5",["c,panel,12.4,2.7,1,-1.5,2.45,0.3,-60,,,-1.5,1.1,0.88,6","c,display-back,11.8,0.8,0.1,-1.5,3.2,0.85,-60,,,-1.5,1.1,0.88,3","c,progress-color-0,1.8,0.3,0.1,-6.5,2.45,0.85,-60,,,-11.5,1.1,0.88,9","c,progress-color-1,1.8,0.3,0.1,-4.5,2.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-color-2,1.8,0.3,0.1,-2.5,2.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-color-3,1.8,0.3,0.1,-0.5,2.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-color-4,1.8,0.3,0.1,1.5,2.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-color-5,1.8,0.3,0.1,3.5,2.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-artist-1,1.8,0.3,0.1,-4.5,1.95,0.85,-60,,,0.5,1.1,0.88,9","c,progress-artist-2,1.8,0.3,0.1,-2.5,1.95,0.85,-60,,,0.5,1.1,0.88,9","c,progress-artist-3,1.8,0.3,0.1,-0.5,1.95,0.85,-60,,,0.5,1.1,0.88,9","c,progress-artist-4,1.8,0.3,0.1,1.5,1.95,0.85,-60,,,0.5,1.1,0.88,9","c,progress-artist-5,1.8,0.3,0.1,3.5,1.95,0.85,-60,,,0.5,1.1,0.88,9","c,progress-artist-0,1.8,0.3,0.1,-6.5,1.95,0.85,-60,,,-11.5,1.1,0.88,9","c,progress-title-1,1.8,0.3,0.1,-4.5,1.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-title-2,1.8,0.3,0.1,-2.5,1.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-title-3,1.8,0.3,0.1,-0.5,1.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-title-4,1.8,0.3,0.1,1.5,1.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-title-5,1.8,0.3,0.1,3.5,1.45,0.85,-60,,,0.5,1.1,0.88,9","c,progress-title-0,1.8,0.3,0.1,-6.5,1.45,0.85,-60,,,-11.5,1.1,0.88,9","p,display,11.8,0.8,,-1.5,2.22,-0.88,30,,,-1.5,2.22,-0.88,8"]],{le:g,we:b,ue:f,pe:g});return t.scale.set(.1,.1,.1),a.Instance.on("progress",e=>{t.l("display").R=G([e.X],{color:R[e.F],textAlign:"left",ratio:14.75,fontSize:B[e.F]}),O.forEach(n=>{for(let s=0;6>s;s++){const r=t.l(`progress-${n}-${s}`);if(!r)continue;let o=M;(e[n].j||e[n].Y>s)&&(o=R[n]),(e[n].j||e[n].Y>s)&&"color"===n&&(o=S[s]);const i=o!==M;r.R.color.set(o),r.R.sn.set(i?o:g),r.R.rn=i?1:0,r.R.Ie=!0}})}),t})();e.add(n),n.position.set(-.1,.9,-.7);const s=(()=>{const t=et(["cy,lid,3.9,0.1,3.9,-0.27,2.1,,,,30,-0.27,2.1,,9","cy,label,4,0.8,4,,0.5,,,,,,0.5,,5","cy,can,3.9,1,3.9,,0.5,,,,,,0.5,,9","cy,tuna,3.8,0.6,3.8,,0.8,,,,,,0.8,,8"],{ue:y,le:v,pe:p});return t.scale.set(.03125,.03125,.03125),t.k.T=!0,t.S=()=>{Q()},t})();e.add(s),s.position.set(-.4,1,-.3);const r=(t=>{const e=new c.h;e.name="Crowd";const n=new c.Ye,s=new c.ge(.5,.5,.5),r=new c.ut,o=new c.je(s,r,80);o.Xe.Ue(c.He);const i=new c.ge(.2,.2,.6),l=new c.ut,h=new c.je(i,l,160);h.Xe.Ue(c.He);const u=new c.ct,w=new c.ct;e.add(o),e.add(h);const f=new c.m(0,-1,0),d=[],p=[];for(let t=0;8>t;t++)for(let e=0;10>e;e++){const s=e+8*t,r=z(nt),i=new c.m(2*e-10+.5+t%2*1,0,2*t-8+.5);5>Math.abs(i.x)||(i.y+=5);const a=new c.m(c.Pt.cn(.3),c.Pt.cn(.1),c.Pt.cn(.3));i.add(a),n.position.Tt(i).add(f),n.an(0,6,0),n.Ke(),o.Ze(s,n.matrix),u.ln(r.he),o.tn(s,u);for(let t=0;2>t;t++){const e=2*s+t;n.position.Tt(i),n.Ke(),h.Ze(e,n.matrix),w.ln(r.he),h.tn(e,w)}d.push({hn:i,un:c.Pt.wn(0,15),palette:r})}return a.Instance.on("tick",()=>{if(!t.xr?.fn())return;const e=t.xr?.fn(),s={dn:[]};if([0,1].forEach(e=>{const n=t.xr?.pn(e);if(n){const t=n.l("paw");t&&s.dn.push(t.gn.clone())}}),e&&(s.camera=e.matrix.clone(),p.push(s),p.length>60&&p.shift()),0==p.length)return o.visible=!1,void(h.visible=!1);d.forEach((t,e)=>{const s=p[Math.max(0,p.length-1-t.un)];s?.camera&&(n.matrix.Tt(s.camera),n.matrix.nn(n.position,n.quaternion,n.scale),n.position.add(t.hn).add(f),n.Ke(),o.Ze(e,n.matrix),s.dn.forEach((s,r)=>{const o=2*e+r;n.matrix.Tt(s),n.matrix.nn(n.position,n.quaternion,n.scale),n.position.add(t.hn).add(f),n.position.add(new c.m(0===r?-.1:.1,.2,-.3)),n.Ke(),h.Ze(o,n.matrix)}))}),o.Xe.Ie=!0,h.Xe.Ie=!0}),e})(t);r.name="Crowd",e.add(r),r.position.set(0,-1,-10),r.rotation.set(0,Math.PI,0);const o=et(["s,head,20,16,16,,8,,,,,,8,,4","s,head,16,16,16,,-5,,,,,,-5,,4",["cy,leftEye,4,1,4,-3,10,-7.1,-71,-5,16,-3,10,-7.1,1","s,leftPupil,2,2,4,-2.8,10.1,-7,-75,7,10,-2.8,10.1,-7,4","cy,rightEye,4,1,4,3,10,-7.2,-71,5,-17,3,10,-7.2,1","s,rightPupil,2,2,4,2.9,10,-7.1,-74,-4,-12,2.9,10,-7.1,4"],["c,rightCheek,4,4,2,1.84,6.03,-7.5,-25,,80,2.34,6.53,-7.5,9","c,leftCheek,4,4,2,-2.91,5.98,-7.5,,23,10,-2.41,6.48,-7.5,9","c,tongue,2,2,2,,5,-7,,,,,4,-7,3","py,pyramid,3,1.6,1,,8.2,-8,-180,,,,8.2,-8,8"],["py,ear,6,7,4,-4.86,13.55,-1.28,-14,20,31,-4.86,13.55,-1.28,4","py,ear,6,7,4,5.14,13.55,-1.28,-11,-15,-33,5.14,13.55,-1.28,4","py,ear,5.2,6.2,3.4,5.14,13.15,-1.78,-9,-16,-33,5.14,13.15,-1.78,1","py,ear,5,5.5,3.8,-5.04,13.54,-1.59,-17,19,32,-5.04,13.54,-1.59,1"],["cy,cylinder,0.2,11,0.2,-7.93,6,-10.12,,-15,90,-7.93,6,-10.12,9","cy,cylinder,0.2,9.2,0.2,-6.87,7.72,-9,,-15,75,-6.87,7.72,-9,9","cy,cylinder,0.2,9,0.2,-7.07,3.78,-9.3,,-15,105,-7.07,3.78,-9.3,9","cy,cylinder,0.2,7.8,0.2,6.87,7.62,-8.9,180,-15,-105,6.87,7.62,-8.9,9","cy,cylinder,0.2,9.4,0.2,6.93,6,-9.52,,-165,90,6.93,6,-9.52,9","cy,cylinder,0.2,8.8,0.2,6.87,3.88,-9.1,180,-15,-75,6.87,3.88,-9.1,9"]],{he:"#333333",pe:"#888888"});o.name="catMesh",o.position.set(-3,1,0),o.scale.set(.1,.1,.1),o.rotation.set(0,-Math.PI/4,0),e.u(o);const i=o.clone(!0);i.name="catMesh2",i.position.set(3,1,0),i.rotation.set(0,Math.PI/4,0),e.u(i);const k=(()=>{const t=et([["c,case1,1,8,2,7.5,7,,,,,7.5,7,,5","c,case2,3,9,2,5.5,7.5,,,,,5.5,7.5,,5","c,case3,8,4,2,,10,,,,,,11.5,,5","c,case4,8,1,2,,5.5,,,,,,5.5,,5","c,case5,3,9,2,-5.5,7.5,,,,,-5.5,7.5,,5","c,case6,1,8,2,-7.5,7,,,,,-7.5,7,,5"],"c,base,12,2.1,2.8,,3.95,,,,,,3,,3","c,rightReel,2,2,1,2.72,6.89,,,,-45,2.72,6.89,,2","c,rightTape,4,4,0.2,2.81,6.91,-0.1,,,-45,2.81,6.91,-0.1,4","c,leftReel,2,2,1,-2.69,6.91,,,,-45,-2.75,7,,2","cy,base,16,8,16,,-4,,,,,,-4,,6","c,label,12,2,2.2,,10,,,,,,9,1,9"],{ue:"#ffcc00",pe:m,le:v,ae:b,he:"#39013a",we:f});return q.Instance.It({At:t,end:{rotation:new c.rt(0,2*Math.PI-.01,0)},duration:16e3,Lt(t){return t},loop:!0}),t})();e.add(k),k.position.set(0,0,-30);const A=new st;e.add(A.At),A.At.position.set(0,-1,-7);const x=(()=>{const t=new c.h;t.name="debugScreen",t.bn=1;const e=new c.Se(5,5);e.translate(0,-2,0);const n=G(["You win!","Thanks for playing","Created by Alex Swan"],{color:"white"}),s=new c.Pe(e,n);return t.add(s),s.position.set(0,0,-20),s.scale.set(.1,.1,.1),s.rotation.set(-Math.PI/2,0,0),s.visible=!1,a.Instance.on("progress",t=>{t.color.j&&t.artist.j&&t.title.j&&(s.k.j=!0,s.visible=!0,s.R.Ie=!0,q.Instance.It({At:s,end:{position:{x:0,y:0,z:0},Et:{x:1,y:1,z:1},rotation:new c.rt(0,0,0)},duration:1e3}))}),t})();e.add(x),x.position.set(0,2,-1);const P=(()=>{const t=new c.h;t.name="Runner";let e=[l,h,u,w,f,d],n=[(t,e)=>0===t||0===e,(t,e)=>1===t||1===e,(t,e)=>2===t||2===e,(t,e)=>3===t||3===e,(t,e)=>4===t||4===e,(t,e)=>5===t||5===e,(t,e)=>e+t===0||12-t-e-2==0,(t,e)=>e+t===1||12-t-e-2==1,(t,e)=>e+t===2||12-t-e-2==2,(t,e)=>e+t===3||12-t-e-2==3,(t,e)=>e+t===4||12-t-e-2==4,(t,e)=>e+t===5||12-t-e-2==5,(t,e)=>(t+e)%2==0,(t,e)=>(t+e)%2==1,(t,e)=>(t+e)%2==0,(t,e)=>(t+e)%2==1,(t,e)=>(t+e)%2==0,(t,e)=>(t+e)%2==1];for(;6>e.length;)e.push(...e);e=e.slice(0,6);let s=-2;const r=new c.ge;r.translate(.5,.5,.5),r.scale(.9,1.1,.9);for(let e=0;6>e;e++)for(let n=0;6>n;n++){const s=new c.ut({color:g}),o=new c.Pe(r,s);o.name=`runner-${n}-${e}`,o.k.x=n,o.k.y=e,o.position.set(-3+n,0,-3+e),t.u(o)}return a.Instance.on("beat",()=>{s+=1,0>s||t.children.forEach(t=>{const{x:r,y:o}=t.k,i=n[s%n.length](r,o),a=i?e[s%e.length]:g;t.R.Ie=!0,t.R.color.set(a),t.R.sn.set(i?a:g),t.R.Ie=!0,t.R.rn=i?1:0,i&&q.Instance.It({At:t,end:{Et:new c.m(1,i?1.1:1,1)},duration:500,Lt:_})})}),t})();return e.add(P),P.position.set(0,-3,-10),P.scale.set(2,1,2),e})(ut);lt.add(x);const P=x.l("tableA"),D=(()=>{new c.m(1,0,0);const t=new c.h;t.name="FishSwirl";const e=[];let n=!0;const s=new c.h,r=et(["c,cube,6,6,8,,,,,,,,-3,,2","c,cube,4,4,11.1,,,-0.55,,,,,-3,,2","c,cube,2,2,2,-2,,-5,,,,-2,-1,-5,4","c,cube,2,2,2,2,,-5,,,,2,-1,-5,4","c,cube,2,6,2,,,6,,,,,-3,7,2","c,cube,1,4,6,,-3,9.5,15,,,,-3,8.5,9","c,cube,1,5,7,,2.5,9.9,-15,,,,2,8.4,2","c,cube,2,5,6,,2.2,,-30,,,,2.7,,2","c,cube,1,2,2,-2.5,-4,-2,,,-40,-3,-3,-2,9","c,cube,3,1,4,-4.5,-3.5,4,,,20,-3,-3,3,9","c,cube,1,2,2,2.5,-4,-2,,,40,3,-3,-2,9","c,cube,3,1,4,4.5,-3.5,4,,,-25,3,-3,3,9"],ot[c.Pt.wn(0,ot.length)]);for(let t=0;10>t;t++){const t=r.clone(!0);t.position.set(10*Math.random()-5,0,0),e.push(t),s.u(t),t.k.vn=new c.m(0,5+3*Math.random(),-5),t.scale.set(0,0,0)}return s.rotation.set(0,0,0),t.u(s),a.Instance.on("tick",t=>{e.forEach(e=>{if(e.k.vn.y-=10*t,e.position.mn(e.k.vn,t),0>e.position.y){const t=new c.m(4*Math.random()-2,0,4*Math.random()-2).sub(e.position).normalize(),n=new c.o;n.yn(new c.m(0,0,-1),t),e.quaternion.Tt(n),e.position.y=0;const s=new c.m(0,0,-1);s.Ae(e.quaternion),s.ot(5),e.k.vn.x=s.x,e.k.vn.z=s.z,e.k.vn.y=5+6*Math.random()}const n=new c.o;n.yn(new c.m(0,0,-1),e.k.vn),e.quaternion.Tt(n)})}),a.Instance.on("progress",t=>{const s=t.U>=4,r=s!==n;e.forEach(t=>{r&&(q.Instance.Dt(t),q.Instance.It({At:t,end:{Et:s?it:new c.m(0,0,0)},duration:s?2e3:1e3}))}),n=s}),t})();D.position.set(0,0,-10),lt.u(D),r.G.forEach((t,e)=>{const n=(({color:t,artist:e,title:n})=>{const s=new c.h,r=new c.Mn(4,7,32);r.translate(0,0,-.001),r.scale(E,E,E);const o=$(t,{lt:!0});s.add(new c.Pe(r,o));const i=new c.Mn(.25,4,32);i.scale(E,E,E),i.translate(0,0,-.001);const a=$(16777215,{});s.add(new c.Pe(i,a));const l=new c.Se(14,14);l.translate(0,0,-.002),l.scale(E,E,E);const h=((t,e)=>{const[n,s]=I();s.fillStyle=g,s.strokeStyle=g,s.lineWidth=8,s.beginPath(),s.arc(512,512,20,0,2*Math.PI),s.stroke(),s.beginPath(),s.arc(512,512,288,0,2*Math.PI),s.stroke(),s.textAlign="center",t&&(s.font="64px monospace",s.textBaseline="middle",s.strokeStyle=g,s.lineWidth=8,s.strokeText(t,512,430.08),s.fillStyle=w,s.fillText(t,512,430.08)),e&&(s.font="96px monospace",s.textBaseline="bottom",s.fillStyle=f,s.strokeText(e,512,696.32),s.fillText(e,512,696.32));const r=new c.gt(n);return r.encoding=c.Rn,new c.ht({map:r,bt:!0})})(e,n);s.add(new c.Pe(l,h));const u=s.clone();u.rotation.set(0,Math.PI,0),s.add(u);const d=new c.Mn(7,7.5,32);d.scale(E,E,E);const b=$(p,{lt:!0});b.rn=1;const v=new c.Pe(d,b);return v.visible=!1,v.name="highlight",s.add(v),s})(t);n.name="vinyl-"+e;const s=new c.m(.7,1.15,-.2-.125*e);n.position.Tt(s),n.k.Sn=s,n.k.T=!0,n.k.kn=e,n.k.An=()=>{lt.u(n),q.Instance.Dt(n),q.Instance.It({At:n,end:{position:n.k.Sn,rotation:new c.rt(0,0,0)},duration:100})},n.S=t=>{if(t.k.selected)return;if(r.J())return;r.selected[t.id]=e;const s=t.l("target");s&&(q.Instance.Dt(n),s.u(n),q.Instance.It({At:n,end:{position:new c.m(0,0,0),rotation:new c.rt(0,Math.PI/2,0)},duration:60}),t.k.selected=n)},n.A=t=>{if(q.Instance.Dt(n,!0),.3>n.Bn(new c.m).xn(P.Bn(new c.m)))return r._(n.k.kn),delete r.selected[t.id],t.k.selected=void 0,P.children.forEach(t=>{t.k.An&&t.k.An()}),P.u(n),X(...[1.01,,275,.01,.01,.15,1,1.03,-3.7,,-93,.07,,,,-.1,,.5,.04,.09]),void q.Instance.It({At:n,end:{position:new c.m(0,.01,0),rotation:new c.rt(-1*Math.PI/2,0,0)},duration:60}).then(()=>{q.Instance.It({At:n,end:{rotation:new c.rt(-1*Math.PI/2,0,-2*Math.PI)},Lt(t){return t},duration:1800,loop:!0})});n.k.An(),t.k.selected=void 0},lt.add(n)}),ft=ut.xr.pn(0),ft.addEventListener("connected",e),ft.addEventListener("selectstart",n),ft.addEventListener("selectend",s),ft.addEventListener("squeezestart",n),ft.addEventListener("squeezeend",s),lt.add(ft),dt=ut.xr.pn(1),dt.addEventListener("connected",e),dt.addEventListener("selectstart",n),dt.addEventListener("selectend",s),dt.addEventListener("squeezestart",n),dt.addEventListener("squeezeend",s),lt.add(dt),ht=new c.Pn,window.addEventListener("resize",yt,!1),a.Instance.on("comboBroken",()=>{Q()}),(async()=>{const t=new Y;await t.init(H),await t.ee();const e=[];for(let n=0;6>n;n++){const s=176400*n,r=t.re(K,s,s+176400);e.push(r)}const n=t.re(K,1058400,1764e3),s=[...e,n];let r=null,o=!1;const i=t=>{let e;r&&(r.stop(),r.disconnect()),e=6>t?t:6;const n=s[e];r=K.createBufferSource(),r.buffer=n,r.connect(K.destination),r.loop=!0,r.start();const c=setInterval(()=>{a.Instance.emit("downbeat"),J!==t&&(clearInterval(c),i(J))},2e3);o=!0};i(J)})(),a.Instance.on("downbeat",()=>{pt>100&&(a.Instance.emit("beat"),pt=0)}),r.reset(),document.getElementById("intro").style.display="none",document.getElementById("c").style.display="block"},yt=()=>{at.aspect=window.innerWidth/window.innerHeight,at.On(),ut.ze(window.innerWidth,window.innerHeight)};window.addEventListener("DOMContentLoaded",()=>{document.getElementById("p").onclick=mt});
